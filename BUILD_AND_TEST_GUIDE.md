# 编译、测试和打包指南

## 一、文件完整性检查

### ✅ 已确认的文件结构
```
src/
├── main.cpp                    ✅
├── app/
│   ├── App.h/.cpp             ✅
│   ├── WndProc.h/.cpp         ✅
│   ├── Menu.rc                ✅
│   └── resource.h             ✅
├── core/
│   ├── Canvas.h/.cpp          ✅
│   ├── Color.h                ✅
│   ├── Math2D.h/.cpp          ✅
│   └── CoordinateAxis.h/.cpp  ✅
├── model/
│   ├── Shape.h                ✅
│   ├── ShapeLine.h/.cpp       ✅
│   ├── ShapeCircle.h/.cpp     ✅
│   ├── ShapeEllipse.h/.cpp    ✅
│   ├── ShapePolygon.h/.cpp    ✅
│   ├── ShapeCurve.h/.cpp      ✅
│   └── ShapeStar.h/.cpp       ✅
├── algorithms/
│   ├── LineDDA.h/.cpp         ✅
│   ├── LineBresenham.h/.cpp   ✅
│   ├── CircleBresenham.h/.cpp ✅
│   ├── EllipseBresenham.h/.cpp✅
│   ├── PolygonDraw.h/.cpp     ✅
│   ├── BezierCurve.h/.cpp     ✅
│   ├── BSplineCurve.h/.cpp    ✅
│   ├── ClipLine.h/.cpp        ✅
│   ├── ClipPolygon.h/.cpp     ✅
│   ├── FillSeed.h/.cpp        ✅
│   └── FillScanline.h/.cpp    ✅ (占位)
└── tools/
    ├── ToolBase.h              ✅
    ├── ToolDrawBasic.h/.cpp    ✅
    ├── ToolTransform.h/.cpp    ✅
    ├── ToolCurve.h/.cpp       ✅
    ├── ToolClip.h/.cpp        ✅
    └── ToolFill.h/.cpp        ✅
```

## 二、编译测试

### 步骤 1：清理项目
1. 在 VS2026 中打开 `CGDrawingSystem.slnx`
2. 菜单：**生成 → 清理解决方案**
3. 删除 `Debug` 和 `Release` 文件夹（如果存在）

### 步骤 2：Debug 编译
1. 选择配置：**Debug | x64**
2. 菜单：**生成 → 生成解决方案** (F7)
3. **检查输出窗口**：
   - ✅ 应该显示 "生成成功"
   - ❌ 如果有错误，检查：
     - 所有 `.cpp` 文件是否都在项目中
     - 头文件路径是否正确
     - 是否有语法错误

### 步骤 3：Release 编译
1. 选择配置：**Release | x64**
2. 菜单：**生成 → 生成解决方案** (F7)
3. **检查输出窗口**：
   - ✅ 应该显示 "生成成功"
   - ❌ 如果有错误，检查：
     - 优化选项是否冲突
     - 链接库是否正确

### 步骤 4：验证输出文件
- Debug: `x64\Debug\CGDrawingSystem.exe`
- Release: `x64\Release\CGDrawingSystem.exe`

## 三、基本功能测试

按照 `TEST_CHECKLIST.md` 逐项测试：

### 3.1 启动测试
- [ ] 运行程序，窗口标题应为："学号_姓名_计算机图形学期末大作业"
- [ ] 窗口中心显示坐标系（x轴、y轴、O/x/y标注）
- [ ] 菜单栏显示五个一级菜单

### 3.2 基本图形绘制测试
**测试顺序**：
1. **DDA 直线**：菜单 → 基本图形绘制 → DDA 直线
   - 左键点起点，再点终点
   - 测试：水平线、垂直线、斜线（四个象限）
   - Esc 取消

2. **Bresenham 直线**：测试同上

3. **系统函数直线**：应显示红色（区别于算法）

4. **Bresenham 圆**：
   - 左键点圆心，再点半径点
   - **重点测试**：圆心在第二象限（窗口左上区域）

5. **Bresenham 椭圆**：测试不同长宽比

6. **矩形**：测试不同大小

7. **多边形**：
   - 左键连续点击添加顶点
   - 右键结束并闭合
   - 观察实时预览

### 3.3 图形变换测试
1. **插入五角星**：菜单 → 图形变换 → 插入预置五角星
   - 窗口中心应出现蓝色五角星

2. **平移**：点击五角星 → 选择平移 → 输入参数（当前默认50）

3. **旋转**：测试不同角度（30°、45°、90°）

4. **缩放**：测试放大和缩小

5. **对称**：测试 x轴/y轴/原点对称

6. **复合变换**：测试复合比例和复合旋转

### 3.4 自由曲线测试
1. **Bezier 曲线**：
   - 2个控制点 = 一次（直线）
   - 3个控制点 = 二次
   - 4个控制点 = 三次
   - 右键结束

2. **B 样条曲线**：
   - 至少4个控制点
   - 右键结束

### 3.5 图形裁剪测试
1. **直线裁剪**：
   - 先绘制几条直线
   - 菜单 → 图形裁剪 → 直线裁剪
   - 左键拖拽选择裁剪矩形
   - 左键点击要裁剪的直线
   - 裁剪结果应为绿色

2. **多边形裁剪**：同上

### 3.6 图形填充测试
1. **种子填充**：
   - 先绘制一个封闭图形（多边形或圆）
   - 菜单 → 图形填充 → 种子填充
   - 左键点击图形内部
   - **观察填充过程演示**（逐步填充）

2. **填充控制**：
   - 播放演示
   - 暂停演示
   - 重置演示

## 四、边界测试

### 4.1 窗口边界测试
- [ ] 绘制超出窗口边界的图形（应正确处理）
- [ ] 窗口最小化/最大化（应正确重绘）
- [ ] 窗口大小改变（坐标系应正确调整）

### 4.2 交互边界测试
- [ ] 快速连续点击（不应崩溃）
- [ ] 点击空白区域（不应崩溃）
- [ ] Esc 键取消操作（应在任何状态下有效）
- [ ] 右键取消（应在任何状态下有效）

### 4.3 算法边界测试
- [ ] 绘制长度为0的直线（起点=终点）
- [ ] 绘制半径为0的圆
- [ ] 绘制退化的多边形（2个顶点）
- [ ] 裁剪完全在窗口外的图形
- [ ] 裁剪完全在窗口内的图形
- [ ] 填充边界上的点

### 4.4 极端数据测试
- [ ] 非常大的坐标值
- [ ] 非常小的坐标值
- [ ] 负坐标值
- [ ] 旋转角度 > 360°

## 五、性能测试

### 5.1 大量图形测试
1. **创建测试场景**：
   - 绘制 100 条直线
   - 绘制 50 个圆
   - 绘制 20 个多边形
   - 绘制 10 条曲线

2. **性能检查**：
   - 窗口重绘是否流畅（无明显延迟）
   - 内存使用是否正常（任务管理器检查）
   - CPU 使用率是否合理

3. **交互响应**：
   - 点击选中图形是否快速响应
   - 变换操作是否流畅

### 5.2 填充性能测试
- [ ] 填充大面积区域（如整个窗口）
- [ ] 观察填充速度是否合理
- [ ] 检查内存使用

## 六、Release 打包

### 6.1 生成 Release 版本
1. 选择配置：**Release | x64**
2. 菜单：**生成 → 重新生成解决方案**
3. 确认生成成功

### 6.2 验证 Release 版本
1. 运行 `x64\Release\CGDrawingSystem.exe`
2. 测试所有基本功能
3. 确认性能正常

### 6.3 检查依赖
Release 版本通常需要以下 DLL（如果使用动态链接）：
- `msvcp140.dll` (C++ Runtime)
- `vcruntime140.dll`
- `vcruntime140_1.dll` (C++17 特性)

**如果缺少 DLL**：
- 选项1：静态链接（推荐）
  - 项目属性 → C/C++ → 代码生成 → 运行时库：`/MT`（Release）
- 选项2：打包 DLL
  - 将 DLL 与 exe 放在同一文件夹

### 6.4 创建压缩包
1. **文件夹结构**：
   ```
   学号_姓名_计算机图形学期末大作业/
   ├── CGDrawingSystem/          (源代码文件夹)
   │   ├── src/
   │   ├── CGDrawingSystem.vcxproj
   │   ├── CGDrawingSystem.slnx
   │   └── ...
   └── CGDrawingSystem.exe       (Release x64 exe)
   ```

2. **压缩包命名**：
   - `学号_姓名_计算机图形学期末大作业.zip` 或 `.rar`

3. **检查清单**：
   - [ ] 包含完整源代码
   - [ ] 包含 Release exe
   - [ ] exe 能独立运行
   - [ ] 压缩包名称正确

## 七、常见问题排查

### 问题1：编译错误 "无法打开包含文件"
**解决**：检查头文件路径，确保使用相对路径 `../`

### 问题2：链接错误 "无法解析的外部符号"
**解决**：
- 检查所有 `.cpp` 文件是否在项目中
- 检查函数声明和定义是否匹配

### 问题3：运行时错误 "应用程序无法正常启动"
**解决**：
- 检查是否缺少 DLL
- 使用静态链接（/MT）

### 问题4：菜单不显示
**解决**：
- 检查 `Menu.rc` 是否在项目中
- 检查资源 ID 是否正确

### 问题5：填充演示不工作
**解决**：
- 检查定时器是否正确设置
- 检查 `WM_TIMER` 消息处理

## 八、最终检查清单

### 代码检查
- [ ] 所有文件已实现
- [ ] 无编译错误
- [ ] 无运行时错误
- [ ] 所有算法通过 `PutPixel()` 实现

### 功能检查
- [ ] 所有菜单功能正常
- [ ] 所有交互正常
- [ ] 坐标系正确显示
- [ ] 窗口标题正确

### 文档检查
- [ ] 代码中有必要注释
- [ ] 算法实现清晰

### 提交检查
- [ ] 窗口标题："学号_姓名_计算机图形学期末大作业"
- [ ] Release exe 能运行
- [ ] 压缩包名称正确
- [ ] 包含源代码和 exe

## 九、性能优化建议（可选）

如果性能有问题，可以考虑：
1. **优化重绘**：只重绘变化区域（使用 `InvalidateRect` 指定区域）
2. **优化填充**：减少每帧填充的像素数
3. **优化图形存储**：使用更高效的数据结构

## 十、测试报告模板

```
测试日期：____
测试环境：Windows 10/11, VS2026
测试结果：
- 编译：✅ Debug / ✅ Release
- 基本功能：✅ 全部通过
- 边界测试：✅ 全部通过
- 性能测试：✅ 正常
- Release 打包：✅ 成功

备注：
```


